{"body":"# Image resize servlet [![Build Status](https://secure.travis-ci.org/soulgalore/image-resize-servlet.png?branch=master)](http://travis-ci.org/soulgalore/image-resize-servlet)\r\n\r\nResize an image using imagemagick (http://www.imagemagick.org/) or thumbnailator (http://code.google.com/p/thumbnailator/) from within a servlet. The servlet will resize an already existing original \r\nimage to one of the predefined desired sizes (or whatever size you want, depending on configuration).\r\n\r\n## What you need\r\n\r\n<ol>\r\n<li>Imagemagick needs to be installed (http://www.imagemagick.org/script/binary-releases.php or by homebrew if you use Mac OS X) and the user of the servlet engine needs to have imagemagick on the path. You need it for all tests to work, even if you will only run thumbnailator.</li>\r\n<li> Simple as that :)</li>\r\n</ol>\r\n\r\n## How to make a test run in Eclipse\r\n<ol>\r\n<li>Checkout the project</li>\r\n<li>Make the project a Maven project (\"Convert to Maven project\")</li>\r\n<li>Start the Tomcat using https://github.com/jsimone/webapp-runner#create-a-launch-configuration</li>\r\n<li>Access http://localhost:8080/thumbs/test-460x360.png and if you see the image, it works.</li>\r\n</ol>\r\n\r\n## How to use it\r\n<ol>\r\n<li>Setup the servlet in your web.xml (you can configure the request parameter name, original image folder, thumbnail base folder and a list of valid sizes of images)</li>\r\n\r\n<li>Access the servlet with the your predefined request parameter with the value of the image you want.\r\n<code>\r\n/SERVLET/?img=MY_ORIGINAL_IMAGE-120x94.png\r\n</code>\r\n</li>\r\n\r\n<li>The images is returned with that size, resized from the file MY_ORIGINAL_IMAGE.png</li>\r\n</ol>\r\n\r\n## How it works\r\nThe servlet will check if the image already exist in the requested size.  If the file exists, it is forwarded to the user. Else the servlet checks if the \r\noriginal image exist (named MY_ORIGINAL_IMAGE.png) and that the requested thumbnail size is valid (you can configure valid size or say that all sizes are valid)\r\n. If the request is valid, a new thumbnail is resized and put in your configured thumbnail base dir + a generated folder path that is calculated from the original file name, so that files are spread within the file system (but all sizes for a specific file, are within the same folder). Then the new image is returned to the user. \r\n\r\nThe calling thread is the thread that creates the actual thumbnail and it is concurrent in the meaning only one thread can create the same thumbnail.\r\n\r\n<img src=\"http://soulgalore.com/image-resize-servlet.png\">\r\n\r\n## Extras\r\nBundled with Tomcat, set it up using and inctructions of how to start: https://github.com/jsimone/webapp-runner \r\n\r\nAlso an expire filter is setup in the web.xml to set some cache headers (so make sure to empty your browser cache if you change images but keep the same name).\r\n\r\nTuckeys url rewrite filter is used to setup a friendly url.\r\n\r\nIf you want to run this in production, you need to think of a couple of things:\r\n<ol>\r\n<li>Change the original and thumbnail directories so they exists outside the webapp (you will probably want the images to live even if you redeploy :) ). If you use Tomcat, configure it by <i>allowLinking</i> to be able to symlink outside your webapp.</li>\r\n<li>Make sure you set correct cache headers and add a layer in front of your servlet runner (Nginx/Apache etc) that can cache the generated image. </li>\r\n<li>Configure your logging backend for slf4j.\r\n</ol>\r\n\r\n## License\r\n\r\nCopyright 2012 Peter Hedenskog\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n   http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\r\n","name":"Image resize servlet","tagline":"Resize image servlet using imagemagick or thumbnailator.","note":"Don't delete this file! It's used internally to help with page regeneration.","google":""}